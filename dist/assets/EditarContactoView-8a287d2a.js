import{_ as R,h as q,y as B,i as c,j as E,q as D,r as I,o as r,c as i,a as o,m as _,w as V,l as u,v as m,n as b,t as p,e as g,k as M,x as k,g as x}from"./index-aef3be03.js";const S={class:"edit-contact-container"},j={class:"header"},$={key:0,class:"loading"},F={key:1,class:"error-state"},O={key:2,class:"card"},G={class:"form-group"},H={key:0,class:"error-message"},J={class:"form-group"},K={class:"form-group"},L={key:0,class:"error-message"},P={class:"form-group"},Q={key:0,class:"error-message"},W={class:"form-group"},X={class:"form-group"},Y={class:"form-actions"},Z=["disabled"],h={__name:"EditarContactoView",setup(ee){const w=q(),z=B(),y=c(null),C=c(!0),f=c(!1),d=c(""),v=c(""),t=E({nombre:"",apellido:"",telefono:"",email:"",direccion:"",notas:""}),a=E({nombre:"",telefono:"",email:""}),N=async()=>{try{const s=await k.get("/contactos/");if(s.data.success){const e=parseInt(z.params.id),l=s.data.data.find(n=>n.id===e);l&&(y.value=l,Object.assign(t,l))}}catch(s){console.error("Error cargando contacto:",s)}finally{C.value=!1}},U=()=>{let s=!0;return a.nombre="",a.telefono="",a.email="",t.nombre.trim()||(a.nombre="El nombre es obligatorio",s=!1),t.telefono.trim()||(a.telefono="El teléfono es obligatorio",s=!1),t.email&&!A(t.email)&&(a.email="El email no tiene un formato válido",s=!1),s},A=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),T=async()=>{var s,e;if(U()){f.value=!0,d.value="";try{const l=await k.put(`/contactos/actualizar.php?id=${y.value.id}`,t);l.data.success?(d.value="¡Contacto actualizado exitosamente!",v.value="success",setTimeout(()=>{w.push("/agenda")},1500)):(d.value=l.data.message||"Error al actualizar contacto",v.value="error")}catch(l){d.value=((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.message)||"Error de conexión",v.value="error"}finally{f.value=!1}}};return D(()=>{N()}),(s,e)=>{const l=I("router-link");return r(),i("div",S,[o("div",j,[e[7]||(e[7]=o("h1",null,"Editar Contacto",-1)),_(l,{to:"/agenda",class:"btn btn-secondary"},{default:V(()=>[...e[6]||(e[6]=[x(" Volver a Agenda ",-1)])]),_:1})]),C.value?(r(),i("div",$,"Cargando contacto...")):y.value?(r(),i("div",O,[o("form",{onSubmit:M(T,["prevent"])},[o("div",G,[e[10]||(e[10]=o("label",{for:"nombre"},"Nombre *",-1)),u(o("input",{type:"text",id:"nombre","onUpdate:modelValue":e[0]||(e[0]=n=>t.nombre=n),required:"",class:b({"input-error":a.nombre})},null,2),[[m,t.nombre]]),a.nombre?(r(),i("span",H,p(a.nombre),1)):g("",!0)]),o("div",J,[e[11]||(e[11]=o("label",{for:"apellido"},"Apellido",-1)),u(o("input",{type:"text",id:"apellido","onUpdate:modelValue":e[1]||(e[1]=n=>t.apellido=n)},null,512),[[m,t.apellido]])]),o("div",K,[e[12]||(e[12]=o("label",{for:"telefono"},"Teléfono *",-1)),u(o("input",{type:"tel",id:"telefono","onUpdate:modelValue":e[2]||(e[2]=n=>t.telefono=n),required:"",class:b({"input-error":a.telefono})},null,2),[[m,t.telefono]]),a.telefono?(r(),i("span",L,p(a.telefono),1)):g("",!0)]),o("div",P,[e[13]||(e[13]=o("label",{for:"email"},"Email",-1)),u(o("input",{type:"email",id:"email","onUpdate:modelValue":e[3]||(e[3]=n=>t.email=n),class:b({"input-error":a.email})},null,2),[[m,t.email]]),a.email?(r(),i("span",Q,p(a.email),1)):g("",!0)]),o("div",W,[e[14]||(e[14]=o("label",{for:"direccion"},"Dirección",-1)),u(o("input",{type:"text",id:"direccion","onUpdate:modelValue":e[4]||(e[4]=n=>t.direccion=n)},null,512),[[m,t.direccion]])]),o("div",X,[e[15]||(e[15]=o("label",{for:"notas"},"Notas",-1)),u(o("textarea",{id:"notas","onUpdate:modelValue":e[5]||(e[5]=n=>t.notas=n),rows:"4"},null,512),[[m,t.notas]])]),o("div",Y,[o("button",{type:"submit",class:"btn btn-primary",disabled:f.value},p(f.value?"Actualizando...":"Actualizar Contacto"),9,Z),_(l,{to:"/agenda",class:"btn btn-secondary"},{default:V(()=>[...e[16]||(e[16]=[x(" Cancelar ",-1)])]),_:1})])],32),d.value?(r(),i("div",{key:0,class:b(["message",v.value])},p(d.value),3)):g("",!0)])):(r(),i("div",F,[e[9]||(e[9]=o("p",null,"Contacto no encontrado",-1)),_(l,{to:"/agenda",class:"btn btn-primary"},{default:V(()=>[...e[8]||(e[8]=[x("Volver a Agenda",-1)])]),_:1})]))])}}},te=R(h,[["__scopeId","data-v-03400753"]]);export{te as default};
